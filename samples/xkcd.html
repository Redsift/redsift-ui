<html>
<head>
  <link rel="stylesheet" type="text/css" href="/css/redsift-xtra.min.css" title="light">
  <style>

    body {
        margin: 1em;
    } 
	
    path.say {
        fill: black;
    }
    text.say {
        fill: white;
        font-size: 22px;
    }
    
  </style>
  </head>

  <body>
	<div class="xkcd">
		<h1>Heading 1</h1>
		<h2>Heading 2</h2>
		<h3>Heading 3</h3>
		<h4>Heading 4</h4>
        <div class="panel">
	    <code>
            int getRandomNumber()</br>
            {</br>
            &emsp;    return 4;   // chosen by fair dice roll.</br>
            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;                // guaranteed to be random.</br>
            }
        </code> 
        </div>
        <p>xkcd clock</p>
        <div id="say"></div>
        <div id="arrows"></div>
      </div>
    
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="/js/redsift-global.es5.min.js"></script>
    <script>
        // https://static.redsift.io/ui/latest/css/redsift-xtra.min.css
        // https://static.redsift.io/ui/latest/js/redsift-global.es5.min.js

        var width = 400, height = 400, textHeight = 30, margin = 16;
            
        
        // the xkcd style is applied as an interpolation function
        // things like the scale of the wiggle can be supplied as a param
        // set this to null to remove the wiggle
        var style = Redsift.Xkcd.wiggle();
                    
        var svg = Redsift.D3.Tools.svgRoot('#say', width+margin*2, textHeight+margin*2);
        var tl = svg.append("g")
                    .attr("transform", "translate(" + margin + ", "
                                                    + margin + ")");
                                                    
        var box = Redsift.D3.Components.box().classed('say').interpolation(style);  


        var ml = width / 2.5;
        var hl = ml / 1.618;
        
        var el = Redsift.D3.Tools.svgRoot('#arrows', width+margin*2, height+margin*2)
                    .append('g')
                    .attr('transform', 'translate(' + margin + ', '
                                                    + margin + ')');
        
        var m = 0;
        var h = 0;        
        var cx = width / 2;
        var cy = height / 2;

        
        // make the circle of the clock using a line                                
        var face = Redsift.D3.Components.line().classed('face').interpolation(style);
        // create the points on the line from 0 -> 360 deg in steps of 2 deg vectors centered
        // at cx and cy with a slight oval shape in the y axis
        var circle = Redsift.D3.Tools.createCircle(0, 360, 2, ml + margin, cx, cy, 0, height/18);
        // bind the data to el and create the path
        el.datum(circle).call(face);
        
        // make another line for the hands
        var hands = Redsift.D3.Components.line().interpolation(style);
                
        function update() {
            // Calculate the position of the hands
            var mRad = m * 2/60 * Math.PI - (Math.PI / 2);
            var mx = ml * Math.cos(mRad); 
            var my = ml * Math.sin(mRad);
            
            var hRad = h * 2/24 * Math.PI - (Math.PI / 2);
            var hx = hl * Math.cos(hRad); 
            var hy = hl * Math.sin(hRad);            
            
            // update the hands
            el.datum([[cx + hx, cy + hy], [cx, cy], [cx + mx, cy + my]]).call(hands);
            
            // update the text    
            tl.datum({x: 0, y: 0, t: "Randall's time " + (h < 10 ? ('0' + h) : h) + ':' + (m < 10 ? ('0' + m) : m), ty: 6, tx: 6}).call(box);                                                 
    
            m++;
            if (m > 60) {
                m = 0;
                h++;
                if (h > 24) {
                    h = 0;
                }
            }    
        }
        update();
                
        // increment every 200ms
       setInterval(update, 200);
	</script>
  </body>

</html>